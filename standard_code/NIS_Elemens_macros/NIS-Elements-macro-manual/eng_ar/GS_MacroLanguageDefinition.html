<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content=""> <meta name="keywords" content=" "> <title>Macro Language Syntax | NIS-Elements</title> <link rel="stylesheet" type="text/css" href="../css/syntax.css"> <link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css"> <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css"> <link rel="stylesheet" type="text/css" href="../css/modern-business.css"> <link rel="stylesheet" type="text/css" href="../css/customstyles.css"> <link rel="stylesheet" type="text/css" href="../css/boxshadowproperties.css"> <link rel="stylesheet" type="text/css" href="../css/ekko-lightbox.min.css"> <link rel="stylesheet" type="text/css" href="../css/ne.css"> <script src="../js/jquery.min.js"></script> <script src="../js/jquery.cookie.min.js"></script> <script src="../js/jquery.navgoco.min.js"></script> <script src="../js/bootstrap.min.js"></script> <script src="../js/ekko-lightbox.min.js"></script> <script src="../js/lightbox.js"></script> <script src="../js/lim_help.js"></script> <script src="../js/jscopy.js"></script> <link rel="shortcut icon" href="../images/favicon_ne.ico""> <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml"> </head> <body> <!-- find project homepage --> <!-- Navigation --> <nav class="navbar navbar-inverse navbar-static-top"> <div class="container-fluid topnavlinks"> <ul class="nav navbar-nav navbar-left"> <!-- separate search window: --> <!--<li><a onclick='window.open("SearchWindow.html","Search","toolbar=0,location=0,directories=0,status=0,menubar=0,top=100,left=100,height=800,width=600");'><img src="images/zoomimage.svg" class="icon"/></a></li>--> <!-- embedded iframe search window: --> <li class="pull-right"> <a href="search.html?frompage=GS_MacroLanguageDefinition.html" id="searchButton" class="searchButton btn btn-primary" title="Search"> <img src="../images/zoomimage.svg" class="icon"/> </a> <div class="searchButtonWrapper"> </div> </li> <li> <a class="fa fa-lg navbar-brand" href="man.html" alt="NIS-Elements"> <img src="../images/logo_ne.svg"/> </a> </li> <!-- entries without drop-downs appear here --> <li class="active"><a href="man.html">User Manual</a></li> <li><a href="cr.html">Menu Commands</a></li> <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Applications<b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="gpa.html">GPA</a></li> <li><a href="nis.ai.html">NIS.ai</a></li> <li><a href="measurement.3d.html">3D Measurement</a></li> <li><a href="analysis.modules.html">Bio Analysis Modules</a></li> <li><a href="app.concrete.html">Concrete</a></li> <li><a href="database.html">Database</a></li> <li><a href="app.deconvolution.html">Deconvolution</a></li> <li><a href="app.edf.html">Extended Depth of Focus</a></li> <li><a href="app.filters.html">Filter Particle Analysis</a></li> <li><a href="app.fret.html">FRET</a></li> <li><a href="app.ga3.html">General Analysis 3 </a></li> <li><a href="ug.hcajobs.html">HCA</a></li> <li><a href="app.hdr.html">HDR</a></li> <li><a href="GS_HowTo.IlluminationSequence.html">Illumination Sequence</a></li> <li><a href="ug.jobs.html">JOBS and HCA</a></li> <li><a href="app.layers.html">Layer Thickness Measurement</a></li> <li><a href="app.sequencer.html">Measurement Sequencer</a></li> <li><a href="app.metalo.castiron.html">Metalo - Cast Iron Analysis</a></li> <li><a href="app.metalo.grainsize.html">Metalo - Grain Size Analysis</a></li> <li><a href="app.nstorm.html">N-STORM</a></li> <li><a href="howto.triggeredacquisition.html">Triggered Acquisition</a></li> <li><a href="app.objectclassifier.html">Object Classifier</a></li> <li><a href="app.se.html">Smart Experiment</a></li> <li><a href="howto.tracking.html">Tracking</a></li> <li><a href="app.welds.html">Weld Measurement</a></li> </ul> </li> <li><a href="fr.html">Macro Functions</a></li> <!-- toggle sidebar button --> <!-- <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li> --> </ul> </div> <!-- /.container --> </nav> <!-- Page Content --> <div class=""> <div id="main" class="fixedPage"> <!-- Sidebar Column --> <div class="fixedSidebar" id="tg-sb-sidebar"> <!--<p>--> <ul id="mysidebar" class="nav"> <li class="sidebarTitle">NIS-Elements AR </li> <li class=" "><a title="Startup" href="p1c1.html">Startup</a> <ul> <li><a title="Command Line Startup Options" href="GS_CommandLineOptions.html">Command Line Startup Options</a></li> </ul> </li> <li class=" "><a title="Installation and Settings" href="ug.startup.html">Installation and Settings</a> <ul> <li><a title="Installation and Updates" href="GS_Install.html">Installation and Updates</a></li> <li><a title="Additional Modules Available in NIS-Elements AR" href="reference.modules.html">Additional Modules Available in NIS-Elements AR</a></li> <li><a title="User Rights" href="GS_UserRights.html">User Rights</a></li> <li><a title="NIS-Elements Preferences" href="adjusting.preferences.html">NIS-Elements Preferences</a></li> <li><a title="NIS-Elements ER Package" href="nis.er.html">NIS-Elements ER Package</a></li> <li><a title="Hardware licences" href="hardware.licences.html">Hardware licences</a></li> </ul> </li> <li class=" "><a title="User Interface" href="ug.gui.html">User Interface</a> <ul> <li><a title="Introduction" href="p1c3s1.html">Introduction</a></li> <li><a title="Compact Layout" href="layout.compact.html">Compact Layout</a></li> <li><a title="Advanced Layout" href="layout.advanced.html">Advanced Layout</a></li> <li><a title="Modifying Layouts" href="GS_LayoutManager_layout.html">Modifying Layouts</a></li> <li><a title="Modifying Toolbars" href="modifying.toolbars.html">Modifying Toolbars</a></li> <li><a title="Modifying Menus" href="p1c3s6.html">Modifying Menus</a></li> <li><a title="Running a Macro Upon Layout Change" href="p1c3s7.html">Running a Macro Upon Layout Change</a></li> <li><a title="Appearance Options" href="options.appearance.html">Appearance Options</a></li> <li><a title="Quick Context Menu" href="QuickContextMenu.html">Quick Context Menu</a></li> <li><a title="Handy Key Shortcuts, Mouse Wheel Options" href="GS_Tips.html">Handy Key Shortcuts, Mouse Wheel Options</a></li> </ul> </li> <li class=" "><a title="Cameras &amp; Devices" href="ug.hwsetup.html">Cameras &amp; Devices</a> <ul> <li><a title="Device Manager" href="visual.device.manager.html">Device Manager</a></li> <li><a title="Objectives" href="GS_Objectives.html">Objectives</a></li> <li><a title="Control of Motorized Devices" href="p1c4s3.html">Control of Motorized Devices</a></li> <li><a title="Camera Settings" href="camera.settings.common.html">Camera Settings</a></li> <li><a title="Optical Configurations" href="GS_Calibration.html">Optical Configurations</a></li> <li><a title="Cameras" href="Mod_Cameras.html">Cameras</a></li> <li><a title="Microscopes" href="reference.devices.html">Microscopes</a></li> <li><a title="Confocal Microscopes" href="confocal.microscopes.html">Confocal Microscopes</a></li> <li><a title="Illumination Devices" href="reference.illuminators.html">Illumination Devices</a></li> <li><a title="Other Devices" href="reference.devices.other.html">Other Devices</a></li> <li><a title="Legacy Cameras and Devices" href="legacy.devices.html">Legacy Cameras and Devices</a></li> </ul> </li> <li class=" "><a title="Confocal Microscope AX" href="ax.html">Confocal Microscope AX</a> <ul> <li><a title="Introduction" href="p1c5s1.html">Introduction</a></li> <li><a title="Experiment Settings" href="ax.experiment.setup.html">Experiment Settings</a></li> <li><a title="Multichannel and Spectral Experiments" href="ax.multichannel.html">Multichannel and Spectral Experiments</a></li> <li><a title="Multiphoton Experiments" href="ax.multiphoton.html">Multiphoton Experiments</a></li> <li><a title="AX Pad" href="ax.pad.html">AX Pad</a></li> <li><a title="AX Scan Area" href="panel.ax.scan.area_section.html">AX Scan Area</a></li> <li><a title="Device Setup" href="ax.device.setup.html">Device Setup</a></li> <li><a title="AX + Ti2-E Automatic Correction Collar" href="p1c5s8.html">AX + Ti2-E Automatic Correction Collar</a></li> </ul> </li> <li class=" "><a title="Image Acquisition" href="GS_Capture.html">Image Acquisition</a> <ul> <li><a title="Experiment Acquisition" href="experiment.acquisition.html">Experiment Acquisition</a></li> <li><a title="Fast Acquisition Using Continuous Movement" href="continuous.movements.html">Fast Acquisition Using Continuous Movement</a></li> <li><a title="Camera ROI" href="roi.camera.html">Camera ROI</a></li> <li><a title="Shading Correction" href="shading.correction.html">Shading Correction</a></li> <li><a title="About ND Acquisition" href="GS_Capture_ND.html">About ND Acquisition</a></li> <li><a title="Time-lapse Acquisition" href="GS_Capture_Time.html">Time-lapse Acquisition</a></li> <li><a title="Multi-point Acquisition" href="GS_Capture_XY.html">Multi-point Acquisition</a></li> <li><a title="Z-series Acquisition" href="GS_Capture_Z.html">Z-series Acquisition</a></li> <li><a title="Multi-channel Acquisition" href="GS_Capture_Mch.html">Multi-channel Acquisition</a></li> <li><a title="Large-image Acquisition" href="GS_Capture_LargeImage.html">Large-image Acquisition</a></li> <li><a title="Inputs/Outputs Control" href="GS_Capture_ND.IO.html">Inputs/Outputs Control</a></li> <li><a title="Combined ND Acquisition" href="GS_ND2.acquisition.html">Combined ND Acquisition</a></li> <li><a title="Smart Acquisition Using JOBS" href="smart.acquisition.html">Smart Acquisition Using JOBS</a></li> <li><a title="Capturing to Ring Buffer" href="GS_Capture_RAM.html">Capturing to Ring Buffer</a></li> <li><a title="Stimulating and Photoactivating" href="howto.stimulation.html">Stimulating and Photoactivating</a></li> <li><a title="File Simulator Setup" href="HT_simulator.html">File Simulator Setup</a></li> </ul> </li> <li class=" "><a title="Displaying Images" href="ug.images.html">Displaying Images</a> <ul> <li><a title="Open, Save, Close Images" href="open.save.close.html">Open, Save, Close Images</a></li> <li><a title="Supported File Formats" href="image.formats.html">Supported File Formats</a></li> <li><a title="Image Layers" href="GS_DocumentStructure.html">Image Layers</a></li> <li><a title="ND Dimensions" href="nd.dimensions.html">ND Dimensions</a></li> <li><a title="Volume Viewer" href="volume.viewer.html">Volume Viewer</a></li> <li><a title="Large Images" href="p1c7s6.html">Large Images</a></li> <li><a title="LUTs - Non-destructive Image Enhancement" href="GS_LUTs.html">LUTs - Non-destructive Image Enhancement</a></li> <li><a title="Organizer" href="GS_OrganizerLayout.html">Organizer</a></li> </ul> </li> <li class=" "><a title="Image Analysis" href="GS_ImageAnalysis.html">Image Analysis</a> <ul> <li><a title="Preparation" href="p1c8s1.html">Preparation</a></li> <li><a title="Image Segmentation" href="ug.segmentation.html">Image Segmentation</a></li> <li><a title="Binary Layers" href="binary.layers.html">Binary Layers</a></li> <li><a title="Regions of Interest - ROIs" href="rois.html">Regions of Interest - ROIs</a></li> </ul> </li> <li class=" "><a title="Measurement" href="ug.measurement.html">Measurement</a> <ul> <li><a title="Calibration" href="calibration.html">Calibration</a></li> <li><a title="Indicative Measurement" href="indicative.measurement.html">Indicative Measurement</a></li> <li><a title="Object Count" href="objectcount.html">Object Count</a></li> <li><a title="Measurement Options" href="options.measurement.html">Measurement Options</a></li> <li><a title="Measurement on Graph" href="measure.on.graph.html">Measurement on Graph</a></li> <li><a title="Pixel Classifier" href="p1c9s6.html">Pixel Classifier</a></li> <li><a title="Manual Measurement" href="p1c9s7.html">Manual Measurement</a></li> <li><a title="Automated Measurement" href="GS_Measurement_Auto.html">Automated Measurement</a></li> <li><a title="Time Measurement" href="timemeas.html">Time Measurement</a></li> <li><a title="Measurement Features" href="GS_MeasurementFeatures.html">Measurement Features</a></li> <li><a title="Exporting Results" href="GS_Export.html">Exporting Results</a></li> <li><a title="Creating Reports" href="GS_ReportGenerator.html">Creating Reports</a></li> </ul> </li> <li class=" "><a title="Macros" href="GS_Macros.html">Macros</a> <ul> <li><a title="Creating Macros" href="creating.macros.html">Creating Macros</a></li> <li><a title="Running a Macro" href="p1c10s2.html">Running a Macro</a></li> <li class="active"><a title="Macro Language Syntax" href="GS_MacroLanguageDefinition.html">Macro Language Syntax</a></li> <li><a title="Controlling Cameras by Macro" href="Mod_Cameras.CameraXet.html">Controlling Cameras by Macro</a></li> <li><a title="Macro Preferences" href="options.macro.html">Macro Preferences</a></li> </ul> </li> <li class=" "><a title="Movies" href="GS_Movie.html">Movies</a> <ul> <li><a title="Capturing AVI Movie" href="GS_Movie.AVI.html">Capturing AVI Movie</a></li> <li><a title="Save ND2 as AVI" href="save.as.avi.html">Save ND2 as AVI</a></li> <li><a title="Creating a Movie from EDF Surface View" href="GS_Movie.moviemaker.html">Creating a Movie from EDF Surface View</a></li> <li><a title="Creating a Movie from Volume View" href="GS_Movie.moviemaker.block.html">Creating a Movie from Volume View</a></li> <li><a title="About Video Compression" href="video.compression.html">About Video Compression</a></li> </ul> </li> <li class=" "><a title="Troubleshooting" href="howto.troubleshooting.html">Troubleshooting</a> <ul> <li><a title="How to send LOG files" href="p1c12s1.html">How to send LOG files</a></li> <li><a title="Determining COM port numbers" href="p1c12s2.html">Determining COM port numbers</a></li> <li><a title="HP Z440/Z840 Power Management" href="troubleshooting_cstate.html">HP Z440/Z840 Power Management</a></li> </ul> </li> <!--if you aren't using the accordion, uncomment this block:--> <!--<p class="external"> <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a> </p>--> </ul> <!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.--> <script>$("li.active").parents('li').toggleClass("active");</script> </div> <!-- Content Column --> <div class="fixedContent" id="tg-sb-content"> <div id="invalidHash"></div> <div class="section page"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="GS_MacroLanguageDefinition"></a>Macro Language Syntax<button class="xmlid" data-clipboard-text="id|GS_MacroLanguageDefinitionx">üîó</button></h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="GS_MacroLanguageDefinition.html#p1c10s3s1">Variable types</a></span></dt><dt><span class="section"><a href="GS_MacroLanguageDefinition.html#p1c10s3s2">Structures and Unions</a></span></dt><dt><span class="section"><a href="GS_MacroLanguageDefinition.html#p1c10s3s3">Arrays</a></span></dt><dt><span class="section"><a href="GS_MacroLanguageDefinition.html#p1c10s3s4">Local and Global Variables</a></span></dt><dt><span class="section"><a href="GS_MacroLanguageDefinition.html#p1c10s3s5">Statements</a></span></dt><dt><span class="section"><a href="GS_MacroLanguageDefinition.html#p1c10s3s6">Directives</a></span></dt><dt><span class="section"><a href="GS_MacroLanguageDefinition.html#p1c10s3s7">Operators</a></span></dt><dt><span class="section"><a href="GS_MacroLanguageDefinition.html#expression.evaluator">Priority of Operators (!)</a></span></dt><dt><span class="section"><a href="GS_MacroLanguageDefinition.html#p1c10s3s9">C-like functions</a></span></dt></dl></div><p>Specifies the <span class="productname">NIS-Elements</span> Macro Language features.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="p1c10s3s1"></a>Variable types<button class="xmlid" data-clipboard-text="id|p1c10s3s1x">üîó</button></h3></div></div></div><div class="variablelist"><p>The following data types are implemented:</p><dl><div class="varlistentry"><span class="term">char</span> <p>text</p></div><div class="varlistentry"><span class="term">char8</span> <p>&lt;-128, +127&gt;</p></div><div class="varlistentry"><span class="term">byte</span> <p>&lt;0, +255&gt;</p></div><div class="varlistentry"><span class="term">int</span> <p>&lt;-32.768, +32.767&gt;</p></div><div class="varlistentry"><span class="term">int64</span> <p>&lt;-9.223.372.036.854.775.808, +9.223.372.036.854.775.807&gt;</p></div><div class="varlistentry"><span class="term">word</span> <p>&lt;0, +65.535&gt;</p></div><div class="varlistentry"><span class="term">long</span> <p>&lt;-2.147.483.648, +2.147.483.647&gt;</p></div><div class="varlistentry"><span class="term">dword</span> <p>&lt;0, +4.294.967.295&gt;</p></div><div class="varlistentry"><span class="term">double</span> <p>&lt;1.7E +/- 308 (15 digits)&gt;</p></div></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="p1c10s3s2"></a>Structures and Unions<button class="xmlid" data-clipboard-text="id|p1c10s3s2x">üîó</button></h3></div></div></div><p>Structures and unions are not supported.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="p1c10s3s3"></a>Arrays<button class="xmlid" data-clipboard-text="id|p1c10s3s3x">üîó</button></h3></div></div></div><p>One and two dimensional arrays are supported.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="p1c10s3s4"></a>Local and Global Variables<button class="xmlid" data-clipboard-text="id|p1c10s3s4x">üîó</button></h3></div></div></div><p>You should declare local variables at the beginning of macro or function only. You should declare global variables only at the beginning of macro. You can run two nested macros declaring the same global variables, but they must be of the same type. You can declare global variables by prefixing the declaration <span class="guilabel">global</span>. Eg.:</p><pre class="synopsis">global int Number_Rows;
global char buffer[200];
</pre><p>The <span class="quote">‚Äú<span class="quote">global</span>‚Äù</span> keyword in front of the variable definition assigns the variable to the global scope. Such variable is then accessible from all function scopes within the macro interpreter.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="p1c10s3s5"></a>Statements<button class="xmlid" data-clipboard-text="id|p1c10s3s5x">üîó</button></h3></div></div></div><div class="variablelist"><p class="title"><b>Supported Statements</b></p><dl><div class="varlistentry"><span class="term">for</span> <p>The <span class="emphasis"><em>for</em></span> statement lets you repeat a statement a specified number of times.</p><pre class="synopsis">Syntax

for([init-expr]; [cond-expr]; [loop-expr])
         statement
</pre><p>First, the initialization (init-expr) is evaluated. Then, while the conditional expression (cond-expr) evaluates to a non zero value, Statement is executed and the loop expression (loop-expr) is evaluated. When cond-expr becomes 0, control passes to the statement the following the for loop.</p></div><div class="varlistentry"><span class="term">while</span> <p>The <span class="emphasis"><em>while</em></span> statement lets you repeat a statement until a specified expression becomes false.</p><pre class="synopsis">Syntax

while(expression) statement
</pre><p>First, the expression is evaluated. If expression is initially false, the body of the while statement is never executed, and control passes from the while statement to the next statement in the program. If expression is true (nonzero), the body of the statement is executed and the process is repeated.</p></div><div class="varlistentry"><span class="term">if, else</span> <p>Conditionally executes a statement or group of statements, depending on the value of an expression.</p><pre class="synopsis">Syntax
if(expression) statement1 
    [else statement2]
</pre><p>The <code class="code">if</code> keyword executes <code class="code">statement1</code> if <code class="code">expression</code> is true (nonzero). If the <code class="code">else</code> keyword is present and <code class="code">expression</code> is false (zero), it executes <code class="code">statement2</code>. After executing <code class="code">statement1</code> or <code class="code">statement2</code>, control passes to the next statement.</p></div><div class="varlistentry"><span class="term">goto</span> <p>Transfers control of the program execution.</p><pre class="synopsis">Syntax

goto name; 
     . . . 
    name: statement
</pre><p>You cannot use goto to jump inside the block from outside. E.g. following is not allowed:</p><pre class="synopsis">goto label; 
    if(k&gt;5) 
      { 
    label: 
       DilateBinary(3, 5); 
       FillHoles(); 
       }
</pre><p>You cannot use goto to jump out from the block more then 2 block levels down. E.g. the following is not allowed:</p><pre class="synopsis">for(i=0; i&lt;64; i=i+1) 
       { 
       for(j=0; j&lt;64; j=j+1) 
          { 
          if(a[i] &gt; b[i]) 
             { 
             value = i; 
             goto end;  // crossing 3 right brackets 
             } 
           } 
        } 
    end
</pre></div><div class="varlistentry"><span class="term">break</span> <p>Terminates the execution of the nearest enclosing statement.</p><pre class="synopsis">Syntax

break;
</pre><p>The <span class="guilabel">break</span> keyword terminates the execution of the smallest enclosing <span class="emphasis"><em>for</em></span> or <span class="emphasis"><em>while</em></span> statement in which it appears. Control passes to the statement that follows the terminated statement.</p></div><div class="varlistentry"><span class="term">continue</span> <p>Passes control to the next iteration of the statement in which it appears.</p><pre class="synopsis">Syntax
continue;
</pre><p>The <span class="emphasis"><em>continue</em></span> keyword passes control to the next iteration of the <span class="emphasis"><em>for</em></span> or <span class="emphasis"><em>while</em></span> statement in which it appears. Within a while statement, the next iteration starts by reevaluating the expression of the while statement. Within a for statement, the first expression of the for statement is evaluated. Then the compiler reevaluates the conditional expression and, depending on the result, either terminates or iterates the statement body.</p></div></dl></div><div class="variablelist"><p class="title"><b>Statements which are not supported</b></p><dl><div class="varlistentry"><span class="term">do, switch, case, default, typedef</span> <p>These statements are not supported.</p></div></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="p1c10s3s6"></a>Directives<button class="xmlid" data-clipboard-text="id|p1c10s3s6x">üîó</button></h3></div></div></div><div class="variablelist"><p>The following directives are supported by the system:</p><dl><div class="varlistentry"><span class="term">define</span> <p>The <span class="emphasis"><em>#define</em></span> directive assigns a meaningful name to a constant in a program.</p><pre class="synopsis">//Syntax

    #define identifier token-string
</pre><p>The directive substitutes token-string for all subsequent occurrences of the identifier in the source file. Token-string can be a value or a string (only for 32-bit version of <span class="productname">NIS-Elements</span>).</p><pre class="synopsis">//Example

    #define ERROR_SPRINTF 0
    #define MAINDIR "c:\Images"

    int main()
    {
    char buf[256];
    int retval; 

    retval = sprintf(buf, "%s", "MAINDIR");
    if(retval == ERROR_SPRINTF)
    Beep();
    else WaitText(0., buf);
    return TRUE;
    }  </pre></div><div class="varlistentry"><span class="term">include</span> <p>Specifies the name of the file to be included.</p><pre class="synopsis">//Syntax

    #include filename</pre><p>The <span class="emphasis"><em>#include</em></span> directive includes the contents a file with a specified filename in the source program at the point where the directive appears.</p><pre class="synopsis">Example
    // if you do  not specify the full path, <span class="productname">NIS-Elements</span> assumes, that it is a relative path to a main directory

    #include "macros\my_macro.h"
    #include "c:\<span class="productname">NIS-Elements</span>\macros\my_macro1.h"
</pre></div><div class="varlistentry"><span class="term">import</span> <p>The <span class="emphasis"><em>#import</em></span> directive is used to incorporate information from an external library.</p><pre class="synopsis">//Syntax

    #import("DLLname"); 
    #import function_declaration
</pre><p><span class="productname">NIS-Elements</span> can call functions from external DLL's. You should import the DLL, where the functions resides and then make a declaration of the functions. You should not import the following system DLL's: kernel32.dll, user32.dll, gdi32.dll, com32.dll, comdlg32.dll. This feature is available only for 32 bit version of <span class="productname">NIS-Elements</span>.</p><pre class="synopsis">//Example

    #import("luc_13.dll");
    #import int RTF_ReplaceVariables(LPSTR destfile, LPSTR sourfile); 
    #import int RTF_FindQuestion(LPSTR sourfile, LPSTR question, long *length, LPSTR defvar);
    #import int RTF_ReplaceQuestion(LPSTR destfile, LPSTR sourfile, LPSTR replacement);
</pre></div><div class="varlistentry"><span class="term">__underC</span> <p>The <span class="emphasis"><em>__underC</em></span> directive assigns a function to be interpreted by the UnderC engine instead of the standard interpreter.</p><pre class="synopsis">//Syntax
//works only on 32bit operating systems

__underC int inter_sharpen(int cols, int rows) { }</pre></div><div class="varlistentry"><span class="term">#importUC</span> <p>The <span class="emphasis"><em>#importUC</em></span> directive imports an API function to the UnderC engine so that it can be used from within there.</p><pre class="synopsis">//Syntax
//works only on 32bit operating systems

#importUC DisplayCurrentPicture;</pre></div></dl></div><div class="example"><a name="d0e49340"></a><p class="title"><b>Example&nbsp;5.&nbsp;Usage of #importUC / __underC</b></p><div class="example-contents"><pre class="programlisting">#importUC DisplayCurrentPicture;

int main()
   {
   int rows, cols;

   AddUndoImage();

   rows = 256;
   cols = 256;

   SetCommandText("Working...");
   Get_Size(SIZE_PICTURE,NULL,NULL,&amp;cols,&amp;rows);

   //Enable_Interrupt_InScript(0);
   Enable_Interrupt_InScript(2);

   inter_sharpen(cols, rows);
   DisplayCurrentPicture();
   }

__underC int inter_sharpen(int cols, int rows)
   {
   int i, j, value;
   for(i=0; i&lt;rows; ++i)
  {
  for(j=0; j&lt;cols; ++j)
     {
     value = 5 * GetPixelValue(-1,i,j,0);
     value = value - GetPixelValue(-1, i-1,j, 0);
     value = value - GetPixelValue(-1, i+1,j, 0);
     value = value - GetPixelValue(-1, i,j+1, 0);
     value = value - GetPixelValue(-1, i,j-1, 0);
     if(value &lt;0) value=0;
     if(value &gt;255) value=255;
     SetPixelValue(0,value,i,j,0);
     }
  if(0 == i % 20)
     DisplayCurrentPicture();
  }
   }
</pre></div></div><br class="example-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="p1c10s3s7"></a>Operators<button class="xmlid" data-clipboard-text="id|p1c10s3s7x">üîó</button></h3></div></div></div><p>The following operators are supported by the system. </p><div class="caution"><h3 class="title">Caution</h3><p>Precedence of operators in <span class="productname">NIS-Elements</span> is different than might be expected. See <a class="xref" href="GS_MacroLanguageDefinition.html#expression.evaluator">Priority of Operators (!)</a>.</p></div><p> </p><div class="variablelist"><p class="title"><b>arithmetic operators</b></p><dl><div class="varlistentry"><span class="term">+</span> <p>Addition</p></div><div class="varlistentry"><span class="term">-</span> <p>Subtraction</p></div><div class="varlistentry"><span class="term">*</span> <p>Multiplication</p></div><div class="varlistentry"><span class="term">/</span> <p>Division</p></div><div class="varlistentry"><span class="term">%</span> <p>Modulo</p></div></dl></div><p> </p><div class="variablelist"><p class="title"><b>assignment operators</b></p><p>The assignment operator assigns the value of the right operand to the left operand.</p><dl><div class="varlistentry"><span class="term">=</span> <p>Addition</p></div></dl></div><p> </p><div class="variablelist"><p class="title"><b>bitwise operators</b></p><p>The bitwise operators compare each bit of the first operand to the corresponding bit of the second operand. The following bitwise operators are supported.</p><dl><div class="varlistentry"><span class="term">&amp;</span> <p>Bitwise AND</p></div><div class="varlistentry"><span class="term">|</span> <p>Bitwise OR</p></div><div class="varlistentry"><span class="term">~</span> <p>One's complement</p></div></dl></div><p> </p><div class="variablelist"><p class="title"><b>pointer operators</b></p><dl><div class="varlistentry"><span class="term">&amp;</span> <p>Address of ?</p></div><div class="varlistentry"><span class="term">*</span> <p>Indirection</p></div></dl></div><p> </p><div class="variablelist"><p class="title"><b>relational operators</b></p><dl><div class="varlistentry"><span class="term">&lt;</span> <p>Less than</p></div><div class="varlistentry"><span class="term">&lt;=</span> <p>Less than or equal to</p></div><div class="varlistentry"><span class="term">&gt;</span> <p>Greater than</p></div><div class="varlistentry"><span class="term">&gt;=</span> <p>Greater than or equal</p></div><div class="varlistentry"><span class="term">==</span> <p>Equal</p></div><div class="varlistentry"><span class="term">!=</span> <p>Not equal</p></div></dl></div><p> </p><div class="variablelist"><p class="title"><b>logical operators</b></p><p>The logical operators perform logical operations on expressions. The following logical operators are supported:</p><dl><div class="varlistentry"><span class="term">&amp;&amp;</span> <p>Logical AND</p></div><div class="varlistentry"><span class="term">||</span> <p>Logical OR</p></div><div class="varlistentry"><span class="term">!</span> <p>Logical NOT</p></div></dl></div><p> </p><div class="caution"><h3 class="title">Caution</h3><p>Precedence of operators in <span class="productname">NIS-Elements</span> is different than might be expected. See <a class="xref" href="GS_MacroLanguageDefinition.html#expression.evaluator">Priority of Operators (!)</a>.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="expression.evaluator"></a>Priority of Operators (!)<button class="xmlid" data-clipboard-text="id|expression.evaluatorx">üîó</button></h3></div></div></div><p>If an expression contains more than one operator:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Logical operators are evaluated <span class="emphasis"><em>from right to left</em></span>!!!</p></li><li class="listitem"><p>It is recommended to always use brackets to define different evaluation order:</p><pre class="synopsis">if( !a &amp;&amp; !b )</pre><p>is evaluated by <span class="productname">NIS-Elements</span> as</p><pre class="synopsis">!( a &amp;&amp; !(b) )</pre><p>To make it work as expected it should be written as:</p><pre class="synopsis">if( (!a) &amp;&amp; (!b) )</pre></li><li class="listitem"><p>Priority of arithmetic operators is standard, division (/), multiplication (*) and modulo (%) have higher priority then other operators.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="p1c10s3s9"></a>C-like functions<button class="xmlid" data-clipboard-text="id|p1c10s3s9x">üîó</button></h3></div></div></div><p>The system can interpret your own C-like functions. An entry point to program is the main() function in your macro. If main() is not presented, for backward compatibility, the body of the macro is also considered as "main function". The new macros should use main() as an entry point.</p><p>The general C-like functions (also called interpreted functions, as opposed to basic system functions from <span class="productname">NIS-Elements</span>) have the following syntax. </p><pre class="synopsis">Syntax

    int MyFunction(int a, LPSTR str, double d) 
    { 
    int retval; 
    . . . 
    return retval; 
    }
</pre><p> </p><div class="variablelist"><dl><div class="varlistentry"><span class="term">Return Value</span> <p>The return value can be any basic data types (char, int, word, dword, int, double or pointer).</p></div><div class="varlistentry"><span class="term">Parameters</span> <p>Parameters can be any basic data types (char int, word, dword, int, double or pointer).</p><div class="note"><h3 class="title">Note</h3><p>Int and double parameters are automatically converted to string type, when they are assigned to text variable, or are one of the parameters of a function.</p></div><pre class="synopsis">Example
    int main()
    {
    char buf[256];
    my_function1(buf);
    WaitText(0., buf);
    return TRUE;
    }

    int my_function1(char *buf)
    {
    strcpy(buf, "This function has a pointer to char array as a parameter");
    return TRUE;
}
</pre></div></dl></div></div></div><div class="footer"><a href="http://www.laboratory-imaging.com" class="footer" target="_blank">Copyright 1991-2025 Laboratory Imaging s.r.o.</a></div><div style="height:30%;width:100%;"></div> </div> <!-- /#main --> </div> </div> </body> </html>
