<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content=""> <meta name="keywords" content=" "> <title>Algorithms | NIS-Elements</title> <link rel="stylesheet" type="text/css" href="../css/syntax.css"> <link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css"> <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css"> <link rel="stylesheet" type="text/css" href="../css/modern-business.css"> <link rel="stylesheet" type="text/css" href="../css/customstyles.css"> <link rel="stylesheet" type="text/css" href="../css/boxshadowproperties.css"> <link rel="stylesheet" type="text/css" href="../css/ekko-lightbox.min.css"> <link rel="stylesheet" type="text/css" href="../css/ne.css"> <script src="../js/jquery.min.js"></script> <script src="../js/jquery.cookie.min.js"></script> <script src="../js/jquery.navgoco.min.js"></script> <script src="../js/bootstrap.min.js"></script> <script src="../js/ekko-lightbox.min.js"></script> <script src="../js/lightbox.js"></script> <script src="../js/lim_help.js"></script> <script src="../js/jscopy.js"></script> <link rel="shortcut icon" href="../images/favicon_ne.ico""> <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml"> </head> <body> <!-- find project homepage --> <!-- Navigation --> <nav class="navbar navbar-inverse navbar-static-top"> <div class="container-fluid topnavlinks"> <ul class="nav navbar-nav navbar-left"> <!-- separate search window: --> <!--<li><a onclick='window.open("SearchWindow.html","Search","toolbar=0,location=0,directories=0,status=0,menubar=0,top=100,left=100,height=800,width=600");'><img src="images/zoomimage.svg" class="icon"/></a></li>--> <!-- embedded iframe search window: --> <li class="pull-right"> <a href="search.html?frompage=deconv.algorithms.html" id="searchButton" class="searchButton btn btn-primary" title="Search"> <img src="../images/zoomimage.svg" class="icon"/> </a> <div class="searchButtonWrapper"> </div> </li> <li> <a class="fa fa-lg navbar-brand" href="man.html" alt="NIS-Elements"> <img src="../images/logo_ne.svg"/> </a> </li> <!-- entries without drop-downs appear here --> <li><a href="man.html">User Manual</a></li> <li><a href="cr.html">Menu Commands</a></li> <li class="dropdown active"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Applications<b class="caret"></b></a> <ul class="dropdown-menu"> <li><a href="gpa.html">GPA</a></li> <li><a href="nis.ai.html">NIS.ai</a></li> <li><a href="measurement.3d.html">3D Measurement</a></li> <li><a href="analysis.modules.html">Bio Analysis Modules</a></li> <li><a href="app.concrete.html">Concrete</a></li> <li><a href="database.html">Database</a></li> <li><a href="app.deconvolution.html">Deconvolution</a></li> <li><a href="app.edf.html">Extended Depth of Focus</a></li> <li><a href="app.filters.html">Filter Particle Analysis</a></li> <li><a href="app.fret.html">FRET</a></li> <li><a href="app.ga3.html">General Analysis 3 </a></li> <li><a href="ug.hcajobs.html">HCA</a></li> <li><a href="app.hdr.html">HDR</a></li> <li><a href="GS_HowTo.IlluminationSequence.html">Illumination Sequence</a></li> <li><a href="ug.jobs.html">JOBS and HCA</a></li> <li><a href="app.layers.html">Layer Thickness Measurement</a></li> <li><a href="app.sequencer.html">Measurement Sequencer</a></li> <li><a href="app.metalo.castiron.html">Metalo - Cast Iron Analysis</a></li> <li><a href="app.metalo.grainsize.html">Metalo - Grain Size Analysis</a></li> <li><a href="app.nstorm.html">N-STORM</a></li> <li><a href="howto.triggeredacquisition.html">Triggered Acquisition</a></li> <li><a href="app.objectclassifier.html">Object Classifier</a></li> <li><a href="app.se.html">Smart Experiment</a></li> <li><a href="howto.tracking.html">Tracking</a></li> <li><a href="app.welds.html">Weld Measurement</a></li> </ul> </li> <li><a href="fr.html">Macro Functions</a></li> <!-- toggle sidebar button --> <!-- <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li> --> </ul> </div> <!-- /.container --> </nav> <!-- Page Content --> <div class=""> <div id="main" class="fixedPage"> <!-- Sidebar Column --> <div class="fixedSidebar" id="tg-sb-sidebar"> <!--<p>--> <ul id="mysidebar" class="nav"> <li class="sidebarTitle">NIS-Elements AR </li> <li class="sidebarSub "> <a title="Deconvolution" href="app.deconvolution.html">Deconvolution</a> </li> <li class=" hidearrow"><a title="Introduction to Deconvolution" href="howto.deconv.intro.html">Introduction to Deconvolution</a> <ul> </ul> </li> <li class=" hidearrow"><a title="Choosing the Deconvolution Method" href="howto.deconv.choose.method.html">Choosing the Deconvolution Method</a> <ul> </ul> </li> <li class="active hidearrow"><a title="Algorithms" href="deconv.algorithms.html">Algorithms</a> <ul> </ul> </li> <li class=" hidearrow"><a title="Determining the Point Spread Function (PSF)" href="howto.deconv.psf.html">Determining the Point Spread Function (PSF)</a> <ul> </ul> </li> <li class=" hidearrow"><a title="Proper Sampling" href="p2c7s5.html">Proper Sampling</a> <ul> </ul> </li> <li class=" "><a title="Dialog Settings" href="p2c7s6.html">Dialog Settings</a> <ul> <li><a title="Automatic Deconvolution" href="automatic.deconvolution.html">Automatic Deconvolution</a></li> <li><a title="3D Deconvolution" href="deconv.settings.3d.html">3D Deconvolution</a></li> <li><a title="2D Deconvolution" href="deconv.settings.2d.html">2D Deconvolution</a></li> <li><a title="Live De-Blur Setup" href="deconv.settings.livedeblur.html">Live De-Blur Setup</a></li> </ul> </li> <li class=" hidearrow"><a title="Running Deconvolution" href="p2c7s7.html">Running Deconvolution</a> <ul> </ul> </li> <!--if you aren't using the accordion, uncomment this block:--> <!--<p class="external"> <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a> </p>--> </ul> <!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.--> <script>$("li.active").parents('li').toggleClass("active");</script> </div> <!-- Content Column --> <div class="fixedContent" id="tg-sb-content"> <div id="invalidHash"></div> <div class="section page"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="deconv.algorithms"></a>Algorithms<button class="xmlid" data-clipboard-text="id|deconv.algorithmsx">üîó</button></h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="deconv.algorithms.html#mod.deconvolution.landweber">Landweber Deconvolution</a></span></dt><dt><span class="section"><a href="deconv.algorithms.html#mod.deconvolution.standard">Richardson-Lucy Deconvolution</a></span></dt><dt><span class="section"><a href="deconv.algorithms.html#mod.deconvolution.blind">Blind Deconvolution</a></span></dt><dt><span class="section"><a href="deconv.algorithms.html#mod.deconvolution.wiener">Fast Deconvolution</a></span></dt><dt><span class="section"><a href="deconv.algorithms.html#p2c7s3s5">Resources</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mod.deconvolution.landweber"></a>Landweber Deconvolution<button class="xmlid" data-clipboard-text="id|mod.deconvolution.landweberx">üîó</button></h3></div></div></div><p>Our model representing observed image is:</p><div class="informalequation"><span class="mathphrase">b = Ax + w</span></div><p>In this equation, (b) is the observed image, (A) is a general transformation matrix and (w) is additional noise. We define the following problem to solve</p><div class="informalequation"><span class="mathphrase">minimize ||Ax-b||<sup>2</sup> + Œª||x||<sub>1</sub></span></div><p>where (Œª) is parameter of the regularization term ‚Äì L1 norm of x. We can restrict matrix (A) from its generality to represent only the space invariant convolution to solve the problem efficiently. The minimization leads us to a two step algorithm.</p><p>Repeat until the convergence is reached:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Wavelet regularization of the intermediate result ‚Äì wavelet soft thresholding</p></li><li class="listitem"><p>Landweber iteration</p></li></ol></div><p>This algorithm is called ISTA and converges quite slowly. There exist many improvements of the algorithm with faster convergency. Here are some of them: TwISTA, SISTA, FISTA, FWISTA. Our Landweber method uses FWISTA.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mod.deconvolution.standard"></a>Richardson-Lucy Deconvolution<button class="xmlid" data-clipboard-text="id|mod.deconvolution.standardx">üîó</button></h3></div></div></div><p>This method is an implementation of the <span class="emphasis"><em>Accelerated Lucy-Richardson</em></span> algorithm with noise regularization. It is assumes that the input PSF parameters are known accurately. The problem which we try to solve can be described by the following equation:</p><div class="informalequation"><span class="mathphrase">C = A * B +N</span></div><p>We know the captured image (C) and the PSF (B). We look for the true image (A) and we know there it is some additional noise (N) present. The <span class="guilabel">*</span> operator stands for convolution. So the equation can be rewritten as:</p><div><img src="../img/deconv_equation_std_lowres.png"></div><p>The Lucy-Richardson (LR) algorithm belongs to the class of so-called Expectation Maximization(EM) algorithms where we assume the noise(N) has a Poisson distribution. We don't need any other characteristics of N. This algorithm estimates A from given B and C iteratively. The algorithm always converges to the result but not so quickly. Because of this, we need to let the algorithm do at least 10 iterations, optimally 30-60 iterations. Performing more than 60 iterations usually has no purpose. The number of iterations can be set within the dialog window.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mod.deconvolution.blind"></a>Blind Deconvolution<button class="xmlid" data-clipboard-text="id|mod.deconvolution.blindx">üîó</button></h3></div></div></div><p>This method is an implementation of the <span class="emphasis"><em>Iterative Asymmetric Blind Deconvolution</em></span> algorithm. It is called <span class="quote">‚Äú<span class="quote">blind</span>‚Äù</span> because PSF is not known exactly. However, at least rough estimation of the PSF parameters is needed. The algorithm improves the PSF/source image estimations iteratively during the deconvolution process. The problem can be described by the following equation</p><div class="informalequation"><span class="mathphrase">C = A * B +N</span></div><p>We know the captured image (C), and we look for the true image (A), PSF (B) and additional noise (N). The <span class="quote">‚Äú<span class="quote">*</span>‚Äù</span> operator stands for convolution. The algorithm then works like this:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>It takes the first estimation of B (B1 - from given parameters) and a spectral characteristic of noise (N1) computed from C and estimates the true image (A1).</p><div class="informalequation"><span class="mathphrase">C = A1 * B1+ N1</span></div></li><li class="listitem"><p>In the second step, it uses the C, A1, and N1 values to re-estimate the PSF(B2)</p><div class="informalequation"><span class="mathphrase">C = A1 * B2+ N1</span></div></li></ul></div><p>In other words this is a sequence of standard deconvolution operations where we reestimate - for odd steps: A<sub>n</sub> from C, A<sub>n-1</sub>; for even steps: A<sub>n</sub> from C, B<sub>n</sub>.</p><p>This re-estimations continue until the defined number of iterations is reached or until the estimated values stop changing. The quality of results of the blind deconvolution depends on the number of iterations. The determination of this number depends on visual inspection of the resulting image.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mod.deconvolution.wiener"></a>Fast Deconvolution<button class="xmlid" data-clipboard-text="id|mod.deconvolution.wienerx">üîó</button></h3></div></div></div><p>This method is an implementation of the <span class="emphasis"><em>Wiener filter</em></span> algorithm. It is assumed that the input PSF parameters are known accurately. The Wiener filter gives us explicit solution of the following equation:</p><div class="informalequation"><span class="mathphrase">C = A * B + N</span></div><p>If we know spectral characteristic of original image(A) and additive noise(N). B means the PSF and C is observed image.</p><p>The result is reached by direct division in Fourier spectrum using the Wiener inverse filter that can be obtained as:</p><div><img src="../img/deconv_equation_fst_lowres.png"></div><p>where FBInv is a fourier transform of inverse filter, FB<sup>*</sup> is a complex conjugate of fourier transform of PSF, FB is fourier transform of PSF, PS<sub>N</sub> is power spectrum of noise, PS<sub>A</sub> is power spectrum of original image (can be substituted by power spectrum of observed image).</p><p>When we obtain FBInv the reconstructed image can be obtained as follows:</p><div class="informalequation"><span class="mathphrase">A' = C*BInv</span></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="p2c7s3s5"></a>Resources<button class="xmlid" data-clipboard-text="id|p2c7s3s5x">üîó</button></h3></div></div></div><p>Articles concerning the algorithms were published by IEEE PAMI. Online access to the articles is charged and therefore cannot be shared here. Follow the links below to gain some more information.</p><div class="variablelist"><dl><div class="varlistentry"><span class="term">Landweber deconvolution</span> <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><a class="ulink" href="https://ieeexplore.ieee.org/document/4454196" target="_blank">A Fast Thresholded Landweber Algorithm for Wavelet-Regularized Multidimensional Deconvolution</a></p></li><li class="listitem"><p><a class="ulink" href="https://ieeexplore.ieee.org/document/5744123" target="_blank">A Fast Wavelet-Based Reconstruction Method for Magnetic Resonance Imaging</a></p></li></ul></div></div><div class="varlistentry"><span class="term">Richardson-Lucy deconvolution</span> <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><a class="ulink" href="https://en.wikipedia.org/wiki/Richardson%E2%80%93Lucy_deconvolution" target="_blank">https://en.wikipedia.org/wiki/Richardson‚ÄìLucy_deconvolution</a></p></li></ul></div></div><div class="varlistentry"><span class="term">Blind deconvolution</span> <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><a class="ulink" href="https://www.osapublishing.org/ol/abstract.cfm?uri=ol-13-7-547" target="_blank">http://www.opticsinfobase.org/abstract.cfm?URI=ol-13-7-547</a></p></li><li class="listitem"><p><a class="ulink" href="https://portal.acm.org/citation.cfm?id=1132228" target="_blank">http://portal.acm.org/citation.cfm?id=1132228</a></p></li></ul></div></div><div class="varlistentry"><span class="term">Fast Deconvolution</span> <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><a class="ulink" href="https://en.wikipedia.org/wiki/Wiener_deconvolution" target="_blank">http://en.wikipedia.org/wiki/Wiener_deconvolution</a></p></li></ul></div></div></dl></div></div></div><div class="footer"><a href="http://www.laboratory-imaging.com" class="footer" target="_blank">Copyright 1991-2025 Laboratory Imaging s.r.o.</a></div><div style="height:30%;width:100%;"></div> </div> <!-- /#main --> </div> </div> </body> </html>
